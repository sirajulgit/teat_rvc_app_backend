name: ðŸš€ Deploy website on push

on:
  push:
    branches:
      - main

jobs:
  deploy:
    name: ðŸš€ Deploy to Server
    runs-on: ubuntu-latest

    steps:
      - name: Deploy using SSH
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.MAIN_SSH_HOST }}
          username: ${{ secrets.MAIN_SSH_USERNAME }}
          password: ${{ secrets.MAIN_SSH_PASSWORD }}
          port: 22
          script: |
              set -e
              export NVM_DIR=~/.nvm
              source ~/.nvm/nvm.sh
              cd /home/realtimevillage-free-vc-ac-chat/htdocs/free-vc-ac-chat.realtimevillage.com
              git pull origin main
              git status
              # rm -rf ./.node_modules
              npm install
              # npx prisma migrate deploy
              # npx prisma generate
              # npm run seed
              pm2 restart free-vc-ac-chat-api-4011
              pm2 save

              